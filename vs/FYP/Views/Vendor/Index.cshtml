
@{
    ViewData["Title"] = "Index";
}

<div style="height: 120px;background-color: #624949;position: relative">
    <div style="position:absolute; text-align:center; width:100%; font-size:40px; color:white; top:30%">
        Vendors
    </div>
</div>
<div style="padding:30px 50px;">
    <div style="margin-bottom:10px; width:100%; height:50px;">
        <div class="btn btn-success btn-circle" style="float:right;" data-toggle="modal" data-target="#exampleModalCenter"><i class="fas fa-plus" style="font-size:17px;"></i></div>
    </div>
    
    <div>
        <table class="table table-striped table-bordered" style="background-color:white;" id="vendorList">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Status</th>
                    <th>Option</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1001</td>
                    <td>My Name</td>
                    <td>TRUE</td>
                    <td></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <form action="#" onsubmit="return createVendor()">
                <div style="background-color:#ffb26e1f;">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLongTitle">Add New Vendor</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-1"></div>
                            <div class="col-10">
                                <div style="font-size: 17px;margin-bottom: 10px;">
                                    <label for="Name">Vendor Name:</label>
                                    <input class="form-control" id="Name" type="text" required />
                                </div>
                                <div style="font-size:17px; margin-bottom:10px;">
                                    <label for="Email">Vendor Email:</label>
                                    <div class="input-group">
                                        <input class="form-control" id="Email" type="email" required />
                                        <div class="input-group-append"><span class="btn btn-warning"><i class="fas fa-search"></i></span></div>
                                    </div>
                                </div>
                                <div style="background-color: #f3ffe5; border-radius: 5px; border: 1px solid #9f9292; padding:10px 20px; margin-top:20px; display:none;">
                                    <div style="font-size:20px; margin-bottom:5px;">User Details</div>
                                    User ID:<br />
                                    First Name:<br />
                                    Last Name:<br />
                                </div>
                            </div>
                            <div class="col-1"></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary" id="createVendorButton">Create</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $('#vendorList').DataTable();
    });

    function createVendor() {
        var status = false;
        $('#createVendorButton').html('<i class="fas fa-undo fa-spin"></i>');
        $.ajax({
            url: '/Api/Vendor/Create',
            type: 'POST',
            contentType:"application/json; charset=utf-8",
            dataType: "json",
            async: false,
            data: JSON.stringify({ 'Email': $('#Email').val(), 'Name': $('#Name').val() }),
            success: function (responds) {
                if (responds.result == "OK") {
                    $('#errorFrame').attr('style', 'display:none;')
                    status = true;
                } else if (responds.result == "FIELD_INCOMPLETE") {
                    $('#loginButton').html('Login Now');
                    $('#errorFrame').removeAttr('style');
                    $('#errorMsg').html('Error: Please login with your email and password.')
                } else if (responds.result == "USER_NOT_FOUND") {
                    $('#loginButton').html('Login Now');
                    $('#errorFrame').removeAttr('style');
                    $('#errorMsg').html('Error: Email/password do not match.')
                } else if (responds.result == "PASSWORD_MISMATCH") {
                    $('#loginButton').html('Login Now');
                    $('#errorFrame').removeAttr('style');
                    $('#errorMsg').html('Error: Email/password do not match.')
                }
            },
            error: function () {
                $('#loginButton').html('Login Now');
            }
        });
        if (status) {
            return true;
        } else {
            return false;
        }
    }
</script>